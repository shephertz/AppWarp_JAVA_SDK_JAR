* Bug fixes in corner cases of connect/disconnect/recover handling

